#ifndef _DIJETCALIBRATION_RESPCORRALGOS_DIJETTREE_H_
#define _DIJETCALIBRATION_RESPCORRALGOS_DIJETTREE_H_

#include <iostream>
#include <vector>

//#include <TROOT.h>
#include "TChain.h"
#include "TFile.h"
#include "TH1D.h"
//#include <TStyle.h>
//#include <TCanvas.h>

#include "DijetCalibration/RespCorrAlgos/interface/DijetRespCorrData.h"
#include "DijetCalibration/RespCorrAlgos/interface/DijetRespCorrDatum.h"

class DijetTree {
public :
   TTree          *fChain;   //!pointer to the analyzed TTree or TChain
   Int_t           fCurrent; //!current Tree number in a TChain

// Fixed size dimensions of array or collections stored in the TTree if any.

   // Declaration of leaf types
   Float_t              tjet_pt;
   Float_t              tjet_p;
   Float_t              tjet_E;
   Float_t              tjet_eta;
   Float_t              tjet_phi;
   Float_t              tjet_EMfrac;
   Float_t              tjet_hadEcalEfrac;
   Float_t              tjet_scale;
   Float_t              tjet_area;
   Int_t                tjet_jetID;
   Float_t              tjet_genpt;
   Float_t              tjet_genp;
   Float_t              tjet_genE;
   Float_t              tjet_gendr;
   Float_t              tjet_unkown_E;
   Float_t              tjet_electron_E;
   Float_t              tjet_muon_E;
   Float_t              tjet_photon_E;
   Float_t              tjet_unkown_px;
   Float_t              tjet_electron_px;
   Float_t              tjet_muon_px;
   Float_t              tjet_photon_px;
   Float_t              tjet_unkown_py;
   Float_t              tjet_electron_py;
   Float_t              tjet_muon_py;
   Float_t              tjet_photon_py;
   Float_t              tjet_unkown_pz;
   Float_t              tjet_electron_pz;
   Float_t              tjet_muon_pz;
   Float_t              tjet_photon_pz;
   Float_t              tjet_unkown_EcalE;
   Float_t              tjet_electron_EcalE;
   Float_t              tjet_muon_EcalE;
   Float_t              tjet_photon_EcalE;
   Int_t                tjet_unkown_n;
   Int_t                tjet_electron_n;
   Int_t                tjet_muon_n;
   Int_t                tjet_photon_n;
   Int_t                tjet_had_n;
   std::vector<float>   *tjet_had_E;
   std::vector<float>   *tjet_had_px;
   std::vector<float>   *tjet_had_py;
   std::vector<float>   *tjet_had_pz;
   std::vector<float>   *tjet_had_EcalE;
   std::vector<float>   *tjet_had_rawHcalE;
   std::vector<float>   *tjet_had_emf;
   std::vector<int>     *tjet_had_id;
   std::vector<int>     *tjet_had_candtrackind;
   std::vector<float>   *tjet_had_E_mctruth;
   std::vector<int>     *tjet_had_mcpdgId;
   std::vector<int>     *tjet_had_ntwrs;
   Int_t                tjet_ntwrs;
   std::vector<int>     *tjet_twr_ieta;
   std::vector<int>     *tjet_twr_iphi;
   std::vector<int>     *tjet_twr_depth;
   std::vector<int>     *tjet_twr_subdet;
   std::vector<float>   *tjet_twr_hade;
   std::vector<float>   *tjet_twr_frac;
   std::vector<int>     *tjet_twr_candtrackind;
   std::vector<int>     *tjet_twr_hadind;
   std::vector<int>     *tjet_twr_elmttype;
   std::vector<float>   *tjet_twr_dR;
   std::vector<int>     *tjet_twr_clusterind;
   Int_t                tjet_cluster_n;
   std::vector<float>   *tjet_cluster_eta;
   std::vector<float>   *tjet_cluster_phi;
   std::vector<float>   *tjet_cluster_dR;
   Int_t                tjet_ncandtracks;
   std::vector<float>   *tjet_candtrack_px;
   std::vector<float>   *tjet_candtrack_py;
   std::vector<float>   *tjet_candtrack_pz;
   std::vector<float>   *tjet_candtrack_EcalE;
   Float_t              pjet_pt;
   Float_t              pjet_p;
   Float_t              pjet_E;
   Float_t              pjet_eta;
   Float_t              pjet_phi;
   Float_t              pjet_EMfrac;
   Float_t              pjet_hadEcalEfrac;
   Float_t              pjet_scale;
   Float_t              pjet_area;
   Int_t                pjet_jetID;
   Float_t              pjet_genpt;
   Float_t              pjet_genp;
   Float_t              pjet_genE;
   Float_t              pjet_gendr;
   Float_t              pjet_unkown_E;
   Float_t              pjet_electron_E;
   Float_t              pjet_muon_E;
   Float_t              pjet_photon_E;
   Float_t              pjet_unkown_px;
   Float_t              pjet_electron_px;
   Float_t              pjet_muon_px;
   Float_t              pjet_photon_px;
   Float_t              pjet_unkown_py;
   Float_t              pjet_electron_py;
   Float_t              pjet_muon_py;
   Float_t              pjet_photon_py;
   Float_t              pjet_unkown_pz;
   Float_t              pjet_electron_pz;
   Float_t              pjet_muon_pz;
   Float_t              pjet_photon_pz;
   Float_t              pjet_unkown_EcalE;
   Float_t              pjet_electron_EcalE;
   Float_t              pjet_muon_EcalE;
   Float_t              pjet_photon_EcalE;
   Int_t                pjet_unkown_n;
   Int_t                pjet_electron_n;
   Int_t                pjet_muon_n;
   Int_t                pjet_photon_n;
   Int_t                pjet_had_n;
   std::vector<float>   *pjet_had_E;
   std::vector<float>   *pjet_had_px;
   std::vector<float>   *pjet_had_py;
   std::vector<float>   *pjet_had_pz;
   std::vector<float>   *pjet_had_EcalE;
   std::vector<float>   *pjet_had_rawHcalE;
   std::vector<float>   *pjet_had_emf;
   std::vector<int>     *pjet_had_id;
   std::vector<int>     *pjet_had_candtrackind;
   std::vector<float>   *pjet_had_E_mctruth;
   std::vector<int>     *pjet_had_mcpdgId;
   std::vector<int>     *pjet_had_ntwrs;
   Int_t                pjet_ntwrs;
   std::vector<int>     *pjet_twr_ieta;
   std::vector<int>     *pjet_twr_iphi;
   std::vector<int>     *pjet_twr_depth;
   std::vector<int>     *pjet_twr_subdet;
   std::vector<float>   *pjet_twr_hade;
   std::vector<float>   *pjet_twr_frac;
   std::vector<int>     *pjet_twr_candtrackind;
   std::vector<int>     *pjet_twr_hadind;
   std::vector<int>     *pjet_twr_elmttype;
   std::vector<float>   *pjet_twr_dR;
   std::vector<int>     *pjet_twr_clusterind;
   Int_t                pjet_cluster_n;
   std::vector<float>   *pjet_cluster_eta;
   std::vector<float>   *pjet_cluster_phi;
   std::vector<float>   *pjet_cluster_dR;
   Int_t                pjet_ncandtracks;
   std::vector<float>   *pjet_candtrack_px;
   std::vector<float>   *pjet_candtrack_py;
   std::vector<float>   *pjet_candtrack_pz;
   std::vector<float>   *pjet_candtrack_EcalE;
   Float_t              dijet_deta;
   Float_t              dijet_dphi;
   Float_t              dijet_balance;
   Float_t              thirdjet_px;
   Float_t              thirdjet_py;
   Float_t              thirdjet_px_uncorr;
   Float_t              thirdjet_py_uncorr;
   Int_t                Run;
   Int_t                Lumi;
   Int_t                Event;
   Int_t                NPV;
   Float_t              weight;

   // List of branches
   TBranch        *b_tjet_pt;
   TBranch        *b_tjet_p;
   TBranch        *b_tjet_E;
   TBranch        *b_tjet_eta;
   TBranch        *b_tjet_phi;
   TBranch        *b_tjet_EMfrac;
   TBranch        *b_tjet_hadEcalEfrac;
   TBranch        *b_tjet_scale;
   TBranch        *b_tjet_area;
   TBranch        *b_tjet_jetID;
   TBranch        *b_tjet_genpt;
   TBranch        *b_tjet_genp;
   TBranch        *b_tjet_genE;
   TBranch        *b_tjet_gendr;
   TBranch        *b_tjet_unkown_E;
   TBranch        *b_tjet_electron_E;
   TBranch        *b_tjet_muon_E;
   TBranch        *b_tjet_photon_E;
   TBranch        *b_tjet_unkown_px;
   TBranch        *b_tjet_electron_px;
   TBranch        *b_tjet_muon_px;
   TBranch        *b_tjet_photon_px;
   TBranch        *b_tjet_unkown_py;
   TBranch        *b_tjet_electron_py;
   TBranch        *b_tjet_muon_py;
   TBranch        *b_tjet_photon_py;
   TBranch        *b_tjet_unkown_pz;
   TBranch        *b_tjet_electron_pz;
   TBranch        *b_tjet_muon_pz;
   TBranch        *b_tjet_photon_pz;
   TBranch        *b_tjet_unkown_EcalE;
   TBranch        *b_tjet_electron_EcalE;
   TBranch        *b_tjet_muon_EcalE;
   TBranch        *b_tjet_photon_EcalE;
   TBranch        *b_tjet_unkown_n;
   TBranch        *b_tjet_electron_n;
   TBranch        *b_tjet_muon_n;
   TBranch        *b_tjet_photon_n;
   TBranch        *b_tjet_had_n;
   TBranch        *b_tjet_had_E;
   TBranch        *b_tjet_had_px;
   TBranch        *b_tjet_had_py;
   TBranch        *b_tjet_had_pz;
   TBranch        *b_tjet_had_EcalE;
   TBranch        *b_tjet_had_rawHcalE;
   TBranch        *b_tjet_had_emf;
   TBranch        *b_tjet_had_id;
   TBranch        *b_tjet_had_candtrackind;
   TBranch        *b_tjet_had_E_mctruth;
   TBranch        *b_tjet_had_mcpdgId;
   TBranch        *b_tjet_had_ntwrs;
   TBranch        *b_tjet_ntwrs;
   TBranch        *b_tjet_twr_ieta;
   TBranch        *b_tjet_twr_iphi;
   TBranch        *b_tjet_twr_depth;
   TBranch        *b_tjet_twr_subdet;
   TBranch        *b_tjet_twr_hade;
   TBranch        *b_tjet_twr_frac;
   TBranch        *b_tjet_twr_candtrackind;
   TBranch        *b_tjet_twr_hadind;
   TBranch        *b_tjet_twr_elmttype;
   TBranch        *b_tjet_twr_dR;
   TBranch        *b_tjet_twr_clusterind;
   TBranch        *b_tjet_cluster_n;
   TBranch        *b_tjet_cluster_eta;
   TBranch        *b_tjet_cluster_phi;
   TBranch        *b_tjet_cluster_dR;
   TBranch        *b_tjet_ncandtracks;
   TBranch        *b_tjet_candtrack_px;
   TBranch        *b_tjet_candtrack_py;
   TBranch        *b_tjet_candtrack_pz;
   TBranch        *b_tjet_candtrack_EcalE;
   TBranch        *b_pjet_pt;
   TBranch        *b_pjet_p;
   TBranch        *b_pjet_E;
   TBranch        *b_pjet_eta;
   TBranch        *b_pjet_phi;
   TBranch        *b_pjet_EMfrac;
   TBranch        *b_pjet_hadEcalEfrac;
   TBranch        *b_pjet_scale;
   TBranch        *b_pjet_area;
   TBranch        *b_pjet_jetID;
   TBranch        *b_pjet_genpt;
   TBranch        *b_pjet_genp;
   TBranch        *b_pjet_genE;
   TBranch        *b_pjet_gendr;
   TBranch        *b_pjet_unkown_E;
   TBranch        *b_pjet_electron_E;
   TBranch        *b_pjet_muon_E;
   TBranch        *b_pjet_photon_E;
   TBranch        *b_pjet_unkown_px;
   TBranch        *b_pjet_electron_px;
   TBranch        *b_pjet_muon_px;
   TBranch        *b_pjet_photon_px;
   TBranch        *b_pjet_unkown_py;
   TBranch        *b_pjet_electron_py;
   TBranch        *b_pjet_muon_py;
   TBranch        *b_pjet_photon_py;
   TBranch        *b_pjet_unkown_pz;
   TBranch        *b_pjet_electron_pz;
   TBranch        *b_pjet_muon_pz;
   TBranch        *b_pjet_photon_pz;
   TBranch        *b_pjet_unkown_EcalE;
   TBranch        *b_pjet_electron_EcalE;
   TBranch        *b_pjet_muon_EcalE;
   TBranch        *b_pjet_photon_EcalE;
   TBranch        *b_pjet_unkown_n;
   TBranch        *b_pjet_electron_n;
   TBranch        *b_pjet_muon_n;
   TBranch        *b_pjet_photon_n;
   TBranch        *b_pjet_had_n;
   TBranch        *b_pjet_had_E;
   TBranch        *b_pjet_had_px;
   TBranch        *b_pjet_had_py;
   TBranch        *b_pjet_had_pz;
   TBranch        *b_pjet_had_EcalE;
   TBranch        *b_pjet_had_rawHcalE;
   TBranch        *b_pjet_had_emf;
   TBranch        *b_pjet_had_id;
   TBranch        *b_pjet_had_candtrackind;
   TBranch        *b_pjet_had_E_mctruth;
   TBranch        *b_pjet_had_mcpdgId;
   TBranch        *b_pjet_had_ntwrs;
   TBranch        *b_pjet_ntwrs;
   TBranch        *b_pjet_twr_ieta;
   TBranch        *b_pjet_twr_iphi;
   TBranch        *b_pjet_twr_depth;
   TBranch        *b_pjet_twr_subdet;
   TBranch        *b_pjet_twr_hade;
   TBranch        *b_pjet_twr_frac;
   TBranch        *b_pjet_twr_candtrackind;
   TBranch        *b_pjet_twr_hadind;
   TBranch        *b_pjet_twr_elmttype;
   TBranch        *b_pjet_twr_dR;
   TBranch        *b_pjet_twr_clusterind;
   TBranch        *b_pjet_cluster_n;
   TBranch        *b_pjet_cluster_eta;
   TBranch        *b_pjet_cluster_phi;
   TBranch        *b_pjet_cluster_dR;
   TBranch        *b_pjet_ncandtracks;
   TBranch        *b_pjet_candtrack_px;
   TBranch        *b_pjet_candtrack_py;
   TBranch        *b_pjet_candtrack_pz;
   TBranch        *b_pjet_candtrack_EcalE;
   TBranch        *b_dijet_deta;
   TBranch        *b_dijet_dphi;
   TBranch        *b_dijet_balance;
   TBranch        *b_thirdjet_px;
   TBranch        *b_thirdjet_py;
   TBranch        *b_thirdjet_px_uncorr;
   TBranch        *b_thirdjet_py_uncorr;
   TBranch        *b_Run;
   TBranch        *b_Lumi;
   TBranch        *b_Event;
   TBranch        *b_NPV;
   TBranch        *b_weight;

   DijetTree(TTree *tree=0, bool MC=false);
   virtual ~DijetTree();
   virtual Int_t    Cut();
   virtual Int_t    GetEntry(Long64_t entry);
   virtual Long64_t LoadTree(Long64_t entry);
   virtual void     Init(TTree *tree);
   virtual void     Loop(DijetRespCorrData*, TH1D*);
   virtual Bool_t   Notify();
   virtual void     Show(Long64_t entry = -1);
   virtual Double_t GetNeutralPUCorr(Double_t, Double_t);
   virtual void     SetCuts(Double_t, Double_t, Double_t, Double_t);

private:
   bool isMC;
   Double_t cut_maxDeltaEta   = 1.5;
   Double_t cut_minSumJetEt   = 50.0;
   Double_t cut_minJetEt      = 20.0;
   Double_t cut_maxThirdJetEt = 100.0;
};

#endif
